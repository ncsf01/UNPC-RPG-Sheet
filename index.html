<!doctype html>
<html lang="en">
  <head>
    <!-- === CSS Imports (modularized) === -->
    <link rel="stylesheet" href="css/base.css" />
    <link rel="stylesheet" href="css/layout.css" />
    <link rel="stylesheet" href="css/portrait.css" />
    <link rel="stylesheet" href="css/inputs.css" />
    <link rel="stylesheet" href="css/buttons.css" />
    <link rel="stylesheet" href="css/dice.css" />
    <link rel="stylesheet" href="css/footer.css" />
    <link rel="stylesheet" href="css/status.css" />
    <link rel="stylesheet" href="css/theme.css" />

    <!-- === Meta + Title === -->
    <meta charset="UTF-8" />
    <title>UNPC RPG Character Sheet</title>
  </head>

  <header></header>
  <body>
    <!-- === HEADER === -->
    <h1>UNPC RPG Character Sheet</h1>

    <div id="controls">
      <button id="darkModeToggle">Dark Mode</button>
      <button id="themeToggle">Theme</button>
      <button id="manageCharacters">Manage Characters</button>
      <button id="cleanSheet">Clean Sheet</button>
    </div>

    <!-- === CHARACTER MANAGER MODAL (hidden by default) === -->
    <div id="characterManager" class="upload-card" style="display: none">
      <h3>Character Manager</h3>

      <!-- Warning message (unchanged) -->
      <p style="color: red; font-weight: bold">
        âš  Characters are saved in your browser's cache and will be lost if you
        clear it.
      </p>

      <!-- Save -->
      <button onclick="saveCharacter()">Save Current Character</button>

      <!-- Saved characters list -->
      <div id="savedList"></div>

      <!-- Upload -->
      <p>Upload JSON Character File</p>
      <input type="file" id="uploadFile" accept="application/json" />
      <br /><br />
      <button onclick="applyCharacterUpload()">Upload</button>

      <!-- Close -->
      <br /><br />
      <button onclick="closeCharacterManager()">Close</button>
    </div>

    <!-- === PORTRAIT UPLOAD MODAL (hidden by default) === -->
    <div id="uploadCard" class="upload-card" style="display: none">
      <h3>Upload Portrait</h3>
      <input type="file" id="portraitUpload" accept="image/*" />
      <br /><br />
      <input type="text" id="portraitUrl" placeholder="Image URL" />
      <br /><br />
      <button onclick="applyPortrait()">Apply</button>
      <button onclick="closeUploadCard()">Cancel</button>
    </div>

    <!-- === THEME MODAL (hidden by default) === -->
    <div id="themeModal" class="modal">
      <div class="modal-content">
        <h3>Select Theme</h3>
        <select id="themeSelect">
          <option value="default">Default</option>
          <option value="fantasy">Fantasy</option>
          <option value="sci-fi">Sci-Fi</option>
          <option value="noir">Noir</option>
        </select>
        <div class="modal-buttons">
          <button onclick="confirmTheme()">OK</button>
          <button onclick="cancelTheme()">Cancel</button>
        </div>
      </div>
    </div>

    <!-- === CHARACTER INFO SECTION === -->
    <div class="section character-info">
      <!-- Portrait card -->
      <div class="card portrait-card">
        <h2>Portrait</h2>
        <div id="portraitWindow">
          <img
            id="portraitImg"
            src="stickfigure.jpg"
            alt="Character Portrait"
          />
          <div class="resize-handle"></div>
        </div>
        <button class="upload-btn" onclick="openUploadCard()">
          Upload Portrait
        </button>
      </div>

      <!-- Details card -->
      <div class="card info-card">
        <h2>Details</h2>
        <input
          type="text"
          id="charName"
          placeholder="Name"
          autocomplete="off"
        />
        <textarea id="charNotes" placeholder="Notes..."></textarea>
      </div>
    </div>

    <!-- === MAIN CONTAINER: Skills + Strikes/Dice Roller === -->
    <div class="container">
      <!-- Skills Section -->
      <div class="section">
        <h2>Skills</h2>
        <button onclick="randomCharacter()">
          ðŸŽ² Generate Random Character
        </button>
        <div class="note">Check specialization box to add +20</div>
        <div class="skills" id="skillsGrid"></div>
      </div>

      <!-- Strikes + Dice Roller Section -->
      <div class="section">
        <h2>Strikes</h2>
        <p><strong>Max Strikes:</strong> <span id="maxStrikes"></span></p>
        <p>
          <strong>Current Strikes Taken:</strong>
          <button onclick="changeStrikes(-1)">-</button>
          <span id="currentStrikes">0</span>
          <button onclick="changeStrikes(1)">+</button>
        </p>
        <p><strong>Status:</strong> <span id="status"></span></p>

        <hr />

        <!-- Dice Roller -->
        <h2>Dice Roller</h2>
        <label>
          Skill:
          <select id="rollSkill" onchange="updateTarget()"></select>
        </label>
        <br />
        <label>
          Difficulty:
          <select id="rollDifficulty" onchange="updateTarget()">
            <option value="40">Very Easy (+40)</option>
            <option value="20">Easy (+20)</option>
            <option value="0" selected>Normal (0)</option>
            <option value="-20">Hard (-20)</option>
            <option value="-40">Formidable (-40)</option>
            <option value="-60">Herculean (-60)</option>
          </select>
        </label>
        <p><strong>Target Number:</strong> <span id="targetNumber"></span></p>
        <button onclick="rollDice()">Roll!</button>
        <p><strong>Result:</strong> <span id="rollResult"></span></p>
      </div>
    </div>

    <!-- === SYSTEM NOTES + MAGIC SECTION === -->
    <div class="container">
      <!-- System Notes -->
      <div class="section">
        <h2>System Notes</h2>
        <ul>
          <li>
            Roll d100 under a skill rating. Modifiers apply to the rating, not
            the dice.
          </li>
          <li>
            <strong>Critical:</strong> Roll â‰¤ tens place of skill (top 10%).
          </li>
          <li><strong>Fumble:</strong> Roll 99 or 00.</li>
          <li>
            <strong>Opposed Rolls:</strong> Both roll; higher wins. Initiator
            wins ties (alt rule: higher roll wins).
          </li>
          <li>
            <strong>Difficulty Modifiers:</strong> Very Easy +40, Easy +20,
            Normal 0, Hard -20, Formidable -40, Herculean -60.
          </li>
        </ul>
      </div>

      <!-- Magic Section -->
      <div class="section">
        <h2>Magic</h2>
        <p>
          Roll WILL vs TN set by GM depending on complexity/severity of the
          spell
        </p>
        <ul>
          <li>Very Easy +40</li>
          <li>Easy +20</li>
          <li>Normal 0</li>
          <li>Hard -20</li>
          <li>Formidable -40</li>
          <li>Herculean -60</li>
        </ul>
      </div>
    </div>

    <!-- Save/Load Window (hidden by default) -->
    <div
      id="saveLoadWindow"
      style="
        display: none;
        border: 2px solid #000;
        padding: 10px;
        margin-top: 20px;
      "
    ></div>

    <!-- === FOOTER (unchanged) === -->
    <footer>
      <p>Fan-made by nicolascsf for UNPC RPG created by Uriah Edwards</p>
      <p>
        <a
          href="https://www.drivethrurpg.com/en/product/532751/the-officially-unofficial-ultimate-no-prep-challenge-rpg"
          target="_blank"
        >
          Get The Officially Unofficial Ultimate No-Prep Challenge RPG!
        </a>
      </p>
    </footer>

    <!-- === JS Imports (modularized) === -->
    <script src="js/skills.js"></script>
    <script src="js/strikes.js"></script>
    <script src="js/dice.js"></script>
    <script src="js/portrait.js"></script>
    <script src="js/character.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/darkmode.js"></script>
    <script src="js/app.js"></script>
  </body>
</html>
